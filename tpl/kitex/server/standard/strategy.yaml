path: biz/strategy/{{SnakeString .ServiceName}}_strategy/{{ SnakeString (index .Methods 0).Name }}.go
loop_method: true
update_behavior:
  type: skip
body: |-
  package {{SnakeString .ServiceName}}_strategy

  import (
  	"context"
    "{{.Module}}/biz/service/{{SnakeString .ServiceName}}"
    // "{{.Module}}/biz/processor/{{SnakeString .ServiceName}}_processor"

  	{{- range $path, $aliases := ( FilterImports .Imports .Methods )}}
  		{{- if not $aliases }}
  			"{{$path}}"
        {{- else if or (eq $path "github.com/cloudwego/kitex/client") (eq $path "github.com/cloudwego/kitex/pkg/serviceinfo")}}
  		{{- else}}
  			{{- range $alias, $is := $aliases}}
  				{{$alias}} "{{$path}}"
  			{{- end}}
  		{{- end}}
  	{{- end}}
  )

  {{range .Methods}}
  func init() {
    // Register the default strategy for {{.Name}}
    {{SnakeString .ServiceName}}.{{.Name}}Strategies["default"] = func(ctx context.Context, {{range .Args}}{{LowerFirst .Name}} {{.Type}}, {{end}}) ({{if not .Void}}{{ .Resp.Type }}, {{end}}error) {
        // TODO: Orchestrate your processor here
        // Example:
        // if err := {{SnakeString .ServiceName}}_processor.CheckPermission(ctx); err != nil { return nil, err }
        // return {{SnakeString .ServiceName}}_processor.Do{{.Name}}(ctx, {{range .Args}}{{LowerFirst .Name}}, {{end}})
        {{if not .Void}}
        return nil, nil
        {{else}}
        return nil
        {{end}}
    }
  }
  {{end}}

